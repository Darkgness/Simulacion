<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Algoritmo de metrópolis guiado y adaptativo | Un paseo guiado por el algoritmo de Metrópolis</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file. “La ponemos despues”</p>" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Algoritmo de metrópolis guiado y adaptativo | Un paseo guiado por el algoritmo de Metrópolis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file. “La ponemos despues”</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Algoritmo de metrópolis guiado y adaptativo | Un paseo guiado por el algoritmo de Metrópolis" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file. “La ponemos despues”</p>" />
  

<meta name="author" content="Guillen García Marieth Agnes, Hernández López Idalia" />


<meta name="date" content="2023-10-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="metrópolis-guiada.html"/>
<link rel="next" href="conclusiones.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#funcionamiento-basico-del-algoritmo-metropolis-y-su-relevancia-en-simulacion-estadistica."><i class="fa fa-check"></i><b>1.1</b> Funcionamiento basico del algoritmo Metropolis y su relevancia en simulacion estadistica.</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="definicion-de-variables-y-funciones-a-utilizar..html"><a href="definicion-de-variables-y-funciones-a-utilizar..html"><i class="fa fa-check"></i><b>2</b> Definicion de variables y funciones a utilizar.</a>
<ul>
<li class="chapter" data-level="2.1" data-path="definicion-de-variables-y-funciones-a-utilizar..html"><a href="definicion-de-variables-y-funciones-a-utilizar..html#lectura-de-datos"><i class="fa fa-check"></i><b>2.1</b> Lectura de Datos</a></li>
<li class="chapter" data-level="2.2" data-path="definicion-de-variables-y-funciones-a-utilizar..html"><a href="definicion-de-variables-y-funciones-a-utilizar..html#funciones-auxiliares"><i class="fa fa-check"></i><b>2.2</b> Funciones Auxiliares</a></li>
<li class="chapter" data-level="2.3" data-path="definicion-de-variables-y-funciones-a-utilizar..html"><a href="definicion-de-variables-y-funciones-a-utilizar..html#estimación-de-máxima-verosimilitud"><i class="fa fa-check"></i><b>2.3</b> Estimación de Máxima Verosimilitud</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="metrópolis-de-paseo-aleatorio.html"><a href="metrópolis-de-paseo-aleatorio.html"><i class="fa fa-check"></i><b>3</b> Metrópolis de paseo aleatorio</a>
<ul>
<li class="chapter" data-level="3.1" data-path="metrópolis-de-paseo-aleatorio.html"><a href="metrópolis-de-paseo-aleatorio.html#concepto-y-funcionamiento-de-algoritmo"><i class="fa fa-check"></i><b>3.1</b> Concepto y funcionamiento de algoritmo</a></li>
<li class="chapter" data-level="3.2" data-path="metrópolis-de-paseo-aleatorio.html"><a href="metrópolis-de-paseo-aleatorio.html#implentación-en-r"><i class="fa fa-check"></i><b>3.2</b> Implentación en R</a></li>
<li class="chapter" data-level="3.3" data-path="metrópolis-de-paseo-aleatorio.html"><a href="metrópolis-de-paseo-aleatorio.html#resultados-e-interpretación"><i class="fa fa-check"></i><b>3.3</b> Resultados e interpretación</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="metrópolis-guiada.html"><a href="metrópolis-guiada.html"><i class="fa fa-check"></i><b>4</b> Metrópolis guiada</a>
<ul>
<li class="chapter" data-level="4.1" data-path="metrópolis-guiada.html"><a href="metrópolis-guiada.html#concepto-y-funcionamiento-de-algoritmo-1"><i class="fa fa-check"></i><b>4.1</b> Concepto y funcionamiento de algoritmo</a></li>
<li class="chapter" data-level="4.2" data-path="metrópolis-guiada.html"><a href="metrópolis-guiada.html#implentación-en-r-1"><i class="fa fa-check"></i><b>4.2</b> Implentación en R</a></li>
<li class="chapter" data-level="4.3" data-path="metrópolis-guiada.html"><a href="metrópolis-guiada.html#resultados-e-interpretación-1"><i class="fa fa-check"></i><b>4.3</b> Resultados e interpretación</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="algoritmo-de-metrópolis-guiado-y-adaptativo.html"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html"><i class="fa fa-check"></i><b>5</b> Algoritmo de metrópolis guiado y adaptativo</a>
<ul>
<li class="chapter" data-level="5.1" data-path="algoritmo-de-metrópolis-guiado-y-adaptativo.html"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#concepto-y-funcionamiento-de-algoritmo-2"><i class="fa fa-check"></i><b>5.1</b> Concepto y funcionamiento de algoritmo</a></li>
<li class="chapter" data-level="5.2" data-path="algoritmo-de-metrópolis-guiado-y-adaptativo.html"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#implentación-en-r-2"><i class="fa fa-check"></i><b>5.2</b> Implentación en R</a></li>
<li class="chapter" data-level="5.3" data-path="algoritmo-de-metrópolis-guiado-y-adaptativo.html"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#resultados-e-interpretación-2"><i class="fa fa-check"></i><b>5.3</b> Resultados e interpretación</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="conclusiones.html"><a href="conclusiones.html"><i class="fa fa-check"></i><b>6</b> Conclusiones</a></li>
<li class="chapter" data-level="7" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i><b>7</b> Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Un paseo guiado por el algoritmo de Metrópolis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="algoritmo-de-metrópolis-guiado-y-adaptativo" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Algoritmo de metrópolis guiado y adaptativo<a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#algoritmo-de-metrópolis-guiado-y-adaptativo" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="concepto-y-funcionamiento-de-algoritmo-2" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Concepto y funcionamiento de algoritmo<a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#concepto-y-funcionamiento-de-algoritmo-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El algoritmo Metrópolis Guiado y Adaptativo es una variante del <em>algoritmo Metrópolis-Hastings</em> que busca mejorar la eficiencia y convergencia del muestreo de Monte Carlo Markov Chain <em>(MCMC)</em>. A continuación, se proporciona una explicación detallada de los conceptos y pasos relacionados con este algoritmo.</p>
<p><strong>Definición del problema:</strong> El algoritmo Metrópolis Guiado y Adaptativo se utiliza para aproximar la distribución de probabilidad de una variable aleatoria de interés, dada una función objetivo o distribución objetivo. Esta distribución objetivo puede ser la distribución posterior en un problema de inferencia bayesiana.</p>
<p><strong>Generación de una cadena de Markov:</strong> Al igual que en el algoritmo Metrópolis-Hastings, el algoritmo Metrópolis Guiado y Adaptativo genera una cadena de Markov, que es una secuencia de estados que evoluciona de acuerdo con ciertas reglas de transición. Cada estado de la cadena representa una posible configuración de la variable aleatoria de interés.</p>
<p><strong>Propuesta de un nuevo estado:</strong> En cada paso de la cadena, se propone un nuevo estado basado en el estado actual. Sin embargo, a diferencia del algoritmo Metrópolis-Hastings estándar, en el algoritmo Metrópolis Guiado y Adaptativo se utiliza una guía o dirección para generar el nuevo estado propuesto. Esta guía puede ser determinada por información adicional o conocimiento previo sobre la distribución objetivo.</p>
<p><strong>Evaluación de la aceptación:</strong> Una vez que se propone un nuevo estado, se evalúa si se acepta o se rechaza. Esto se hace calculando la razón de aceptación, que es la proporción entre la densidad de probabilidad de la distribución objetivo evaluada en el nuevo estado propuesto y la densidad de probabilidad evaluada en el estado actual. Si la razón de aceptación es mayor o igual a uno, se acepta el nuevo estado. Si es menor que uno, se acepta el nuevo estado con una probabilidad igual a la razón de aceptación.</p>
<p><strong>Actualización del estado:</strong> Si se acepta el nuevo estado, se actualiza el estado actual de la cadena con el nuevo estado propuesto. Si se rechaza el nuevo estado, se mantiene el estado actual sin cambios.</p>
<p><strong>Adaptación de la Propuesta:</strong> Una característica clave del algoritmo Metrópolis Guiado y Adaptativo es la adaptación de la propuesta de salto. La desviación estándar de la distribución de salto se ajusta automáticamente durante el proceso de muestreo para mejorar la eficiencia del algoritmo.</p>
</div>
<div id="implentación-en-r-2" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Implentación en R<a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#implentación-en-r-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-1" tabindex="-1"></a><span class="co"># initialize</span></span>
<span id="cb37-2"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-2" tabindex="-1"></a>M<span class="ot">=</span><span class="dv">10000</span> <span class="co"># Se generan 10000 muestras en total</span></span>
<span id="cb37-3"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-3" tabindex="-1"></a>burnin<span class="ot">=</span><span class="dv">1000</span> <span class="co"># se defne la cantidad de iteracion inicial</span></span>
<span id="cb37-4"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">91828</span>) <span class="co"># se establece la semilla</span></span>
<span id="cb37-5"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-5" tabindex="-1"></a>beta_post_adaptguide <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">nrow=</span>M<span class="sc">+</span>burnin, <span class="at">ncol=</span><span class="dv">2</span>) <span class="co">#Matriz para almacenar coeficientes del modelo</span></span>
<span id="cb37-6"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-6" tabindex="-1"></a><span class="fu">colnames</span>(beta_post_adaptguide) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;beta0&#39;</span>, <span class="st">&#39;beta1&#39;</span>) <span class="co"># designar nombres a las columnas</span></span>
<span id="cb37-7"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-7" tabindex="-1"></a>accept <span class="ot">=</span> <span class="fu">numeric</span>(M<span class="sc">+</span>burnin) <span class="co"># vector numerico de las M muestras + las iteraciones </span></span>
<span id="cb37-8"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-8" tabindex="-1"></a>rd_adaptguide <span class="ot">=</span> <span class="fu">numeric</span>(M<span class="sc">+</span>burnin) <span class="co"># vector numerico de las M muestras + las iteraciones </span></span>
<span id="cb37-9"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-9" tabindex="-1"></a>beta_post_adaptguide[<span class="dv">1</span>,] <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="sc">-</span><span class="dv">3</span>) <span class="co"># se establece la primera fila con valores iniciales (2, -3)</span></span>
<span id="cb37-10"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-10" tabindex="-1"></a>rd_adaptguide[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">riskdifference</span>(y,x,beta_post[<span class="dv">1</span>,])  <span class="co"># dif. de riesgo de las estimaciones</span></span>
<span id="cb37-11"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-11" tabindex="-1"></a>accept[<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span> <span class="co"># Vector para registrar si la muestra es aceptada (1) o rechazada (0)</span></span>
<span id="cb37-12"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-12" tabindex="-1"></a>prop.sigma <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>) <span class="co"># Vector con desviaciones estandar iniciales </span></span>
<span id="cb37-13"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-13" tabindex="-1"></a>dir <span class="ot">=</span> <span class="dv">1</span> <span class="co"># Esta variable se utiliza para controlar la dirección de exploración</span></span>
<span id="cb37-14"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-14" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(M<span class="sc">+</span>burnin)){</span>
<span id="cb37-15"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-15" tabindex="-1"></a>  <span class="cf">if</span>((i <span class="sc">&lt;</span> burnin) <span class="sc">&amp;</span> (i <span class="sc">&gt;</span> <span class="dv">25</span>)){</span>
<span id="cb37-16"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-16" tabindex="-1"></a>    prop.sigma <span class="ot">=</span> <span class="fu">apply</span>(beta_post_adaptguide[<span class="fu">max</span>(<span class="dv">1</span>, i<span class="dv">-100</span>)<span class="sc">:</span>(i<span class="dv">-1</span>),], <span class="dv">2</span>, sd)</span>
<span id="cb37-17"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-17" tabindex="-1"></a>  } <span class="co"># si 25 &gt; i &lt; 1000 se calcula SD de muestras anteriores para guiar la propuesta.</span></span>
<span id="cb37-18"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-18" tabindex="-1"></a>  oldb <span class="ot">=</span> beta_post_adaptguide[i<span class="dv">-1</span>,] <span class="co"># almacena los coeficientes de la muestra anterior</span></span>
<span id="cb37-19"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-19" tabindex="-1"></a>  prop <span class="ot">=</span> dir<span class="sc">*</span><span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">2</span>, <span class="at">sd=</span>prop.sigma)) <span class="co"># propuesta nuevo coeficiente * dir</span></span>
<span id="cb37-20"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-20" tabindex="-1"></a>  newb <span class="ot">=</span> oldb<span class="sc">+</span>prop <span class="co"># Calcula los nuevos coeficientes al sumar la propuesta</span></span>
<span id="cb37-21"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-21" tabindex="-1"></a>  num <span class="ot">=</span> <span class="fu">loglik</span>(y,x,newb) <span class="co"># Calculan el logaritmo de verosimilitud para newb</span></span>
<span id="cb37-22"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-22" tabindex="-1"></a>  den <span class="ot">=</span> <span class="fu">loglik</span>(y,x,oldb) <span class="co"># Calculan el logaritmo de verosimilitud para oldb</span></span>
<span id="cb37-23"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-23" tabindex="-1"></a>  acceptprob <span class="ot">=</span> <span class="fu">exp</span>(num<span class="sc">-</span>den) <span class="co"># calcula la probabilidad de aceptar la newb  </span></span>
<span id="cb37-24"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-24" tabindex="-1"></a>  acc <span class="ot">=</span> (acceptprob <span class="sc">&gt;</span> <span class="fu">runif</span>(<span class="dv">1</span>)) <span class="co"># aceptar o rechazar la nueva función anterior</span></span>
<span id="cb37-25"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-25" tabindex="-1"></a>  <span class="cf">if</span>(acc){</span>
<span id="cb37-26"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-26" tabindex="-1"></a>    beta_post_adaptguide[i,] <span class="ot">=</span> newb  </span>
<span id="cb37-27"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-27" tabindex="-1"></a>    accept[i] <span class="ot">=</span> <span class="dv">1</span> <span class="co"># se almacenan si es aceptada</span></span>
<span id="cb37-28"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-28" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb37-29"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-29" tabindex="-1"></a>    beta_post_adaptguide[i,] <span class="ot">=</span> oldb </span>
<span id="cb37-30"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-30" tabindex="-1"></a>    accept[i] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb37-31"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-31" tabindex="-1"></a>    dir <span class="ot">=</span> dir<span class="sc">*-</span><span class="dv">1</span> <span class="co"># se invierte la dirección dir multiplicándola por -1.</span></span>
<span id="cb37-32"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-32" tabindex="-1"></a>    <span class="co"># cambia la dirección de exploración en el espacio de parámetros.</span></span>
<span id="cb37-33"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-33" tabindex="-1"></a>  }</span>
<span id="cb37-34"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-34" tabindex="-1"></a>  <span class="co"># Calcula y almacena la diferencia de riesgo para cada conjunto de estimaciones</span></span>
<span id="cb37-35"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-35" tabindex="-1"></a>  rd_adaptguide[i] <span class="ot">=</span> <span class="dv">1000</span><span class="sc">*</span><span class="fu">riskdifference</span>(y,x,beta_post_adaptguide[i,])</span>
<span id="cb37-36"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-36" tabindex="-1"></a>}</span>
<span id="cb37-37"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-37" tabindex="-1"></a></span>
<span id="cb37-38"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-38" tabindex="-1"></a><span class="co"># luego del período de &quot;burn-in&quot; se calcula el valor </span></span>
<span id="cb37-39"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-39" tabindex="-1"></a><span class="co"># del posterior promedio de los coeficientes </span></span>
<span id="cb37-40"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-40" tabindex="-1"></a>postmean <span class="ot">=</span> <span class="fu">apply</span>(beta_post_adaptguide[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>),], <span class="dv">2</span>, mean)</span>
<span id="cb37-41"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb37-41" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Posterior mean, guided and adaptive</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="fu">round</span>(postmean, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>Posterior mean, guided and adaptive
 -1.78 1.22</code></pre>
</div>
<div id="resultados-e-interpretación-2" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Resultados e interpretación<a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#resultados-e-interpretación-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Estos gráficos proporcionan una visualización de cómo se están comportando las cadenas de Markov generadas por dos métodos diferentes. Puedes observar cómo evolucionan las trazas a lo largo de las iteraciones y si convergen hacia valores estables. La comparación entre los dos métodos ayuda a evaluar la eficacia del enfoque guiado y adaptativo en comparación con la caminata aleatoria:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb39-1" tabindex="-1"></a>col1 <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">5</span>)</span>
<span id="cb39-2"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb39-2" tabindex="-1"></a>col2 <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">35</span>)</span>
<span id="cb39-3"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb39-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb39-4"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb39-4" tabindex="-1"></a></span>
<span id="cb39-5"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb39-5" tabindex="-1"></a><span class="co">#trace plots</span></span>
<span id="cb39-6"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb39-6" tabindex="-1"></a><span class="fu">plot</span>(beta_post[<span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>,<span class="dv">2</span>], <span class="at">type=</span><span class="st">&#39;l&#39;</span>,  <span class="at">ylab=</span><span class="fu">expression</span>(beta[<span class="dv">1</span>]), <span class="at">xlab=</span><span class="st">&quot;Iteration&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>), <span class="at">col=</span>col1)</span>
<span id="cb39-7"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb39-7" tabindex="-1"></a><span class="fu">lines</span>(beta_post_adaptguide[<span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>,<span class="dv">2</span>], <span class="at">col=</span>col2)</span>
<span id="cb39-8"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb39-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(col1, col2), <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Rand. walk&quot;</span>, <span class="st">&quot;Guided, adaptive&quot;</span>))</span>
<span id="cb39-9"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb39-9" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">9800</span><span class="sc">:</span><span class="dv">10000</span>, beta_post[<span class="dv">9800</span><span class="sc">:</span><span class="dv">10000</span>,<span class="dv">2</span>], <span class="at">type=</span><span class="st">&#39;l&#39;</span>,  <span class="at">ylab=</span><span class="fu">expression</span>(beta[<span class="dv">1</span>]), <span class="at">xlab=</span><span class="st">&quot;Iteration&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>), <span class="at">col=</span>col1)</span>
<span id="cb39-10"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb39-10" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">9800</span><span class="sc">:</span><span class="dv">10000</span>, beta_post_adaptguide[<span class="dv">9800</span><span class="sc">:</span><span class="dv">10000</span>,<span class="dv">2</span>], <span class="at">col=</span>col2)</span>
<span id="cb39-11"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb39-11" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(col1, col2), <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Rand. walk&quot;</span>, <span class="st">&quot;Guided, adaptive&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Estos gráficos de densidad permiten comparar las distribuciones de dos conjuntos de datos, uno generado mediante el método de caminata aleatoria estándar y otro mediante el método guiado y adaptativo:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb40-1" tabindex="-1"></a><span class="co"># density plots</span></span>
<span id="cb40-2"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb40-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(beta_post_adaptguide[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>),<span class="dv">2</span>]), <span class="at">col=</span>col2, <span class="at">xlab=</span><span class="fu">expression</span>(beta[<span class="dv">1</span>]), <span class="at">ylab=</span><span class="st">&quot;Density&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb40-3"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb40-3" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(beta_post[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>),<span class="dv">2</span>]), <span class="at">col=</span>col1)</span>
<span id="cb40-4"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb40-4" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(col1, col2), <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Rand. walk&quot;</span>, <span class="st">&quot;Guided, adaptive&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb41-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(rd_adaptguide[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)]), <span class="at">xlab=</span><span class="st">&quot;RD*1000&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Density&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">col=</span>col2)</span>
<span id="cb41-2"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb41-2" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(rd[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)]), <span class="at">col=</span>col1)</span>
<span id="cb41-3"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb41-3" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(col1, col2), <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Rand. walk&quot;</span>, <span class="st">&quot;Guided, adaptive&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#cb42-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="metrópolis-guiada.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="conclusiones.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/index.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
