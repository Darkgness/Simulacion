<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Metrópolis de paseo aleatorio | Un paseo guiado por el algoritmo de Metrópolis</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file. “La ponemos despues”</p>" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Metrópolis de paseo aleatorio | Un paseo guiado por el algoritmo de Metrópolis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file. “La ponemos despues”</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Metrópolis de paseo aleatorio | Un paseo guiado por el algoritmo de Metrópolis" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file. “La ponemos despues”</p>" />
  

<meta name="author" content="Guillen García Marieth Agnes, Hernández López Idalia" />


<meta name="date" content="2023-10-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="definicion-de-variables-y-funciones-a-utilizar..html"/>
<link rel="next" href="metrópolis-guiada.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#funcionamiento-basico-del-algoritmo-metropolis-y-su-relevancia-en-simulacion-estadistica."><i class="fa fa-check"></i><b>1.1</b> Funcionamiento basico del algoritmo Metropolis y su relevancia en simulacion estadistica.</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="definicion-de-variables-y-funciones-a-utilizar..html"><a href="definicion-de-variables-y-funciones-a-utilizar..html"><i class="fa fa-check"></i><b>2</b> Definicion de variables y funciones a utilizar.</a>
<ul>
<li class="chapter" data-level="2.1" data-path="definicion-de-variables-y-funciones-a-utilizar..html"><a href="definicion-de-variables-y-funciones-a-utilizar..html#lectura-de-datos"><i class="fa fa-check"></i><b>2.1</b> Lectura de Datos</a></li>
<li class="chapter" data-level="2.2" data-path="definicion-de-variables-y-funciones-a-utilizar..html"><a href="definicion-de-variables-y-funciones-a-utilizar..html#funciones-auxiliares"><i class="fa fa-check"></i><b>2.2</b> Funciones Auxiliares</a></li>
<li class="chapter" data-level="2.3" data-path="definicion-de-variables-y-funciones-a-utilizar..html"><a href="definicion-de-variables-y-funciones-a-utilizar..html#estimación-de-máxima-verosimilitud"><i class="fa fa-check"></i><b>2.3</b> Estimación de Máxima Verosimilitud</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="metrópolis-de-paseo-aleatorio.html"><a href="metrópolis-de-paseo-aleatorio.html"><i class="fa fa-check"></i><b>3</b> Metrópolis de paseo aleatorio</a>
<ul>
<li class="chapter" data-level="3.1" data-path="metrópolis-de-paseo-aleatorio.html"><a href="metrópolis-de-paseo-aleatorio.html#concepto-y-funcionamiento-de-algoritmo"><i class="fa fa-check"></i><b>3.1</b> Concepto y funcionamiento de algoritmo</a></li>
<li class="chapter" data-level="3.2" data-path="metrópolis-de-paseo-aleatorio.html"><a href="metrópolis-de-paseo-aleatorio.html#implentación-en-r"><i class="fa fa-check"></i><b>3.2</b> Implentación en R</a></li>
<li class="chapter" data-level="3.3" data-path="metrópolis-de-paseo-aleatorio.html"><a href="metrópolis-de-paseo-aleatorio.html#resultados-e-interpretación"><i class="fa fa-check"></i><b>3.3</b> Resultados e interpretación</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="metrópolis-guiada.html"><a href="metrópolis-guiada.html"><i class="fa fa-check"></i><b>4</b> Metrópolis guiada</a>
<ul>
<li class="chapter" data-level="4.1" data-path="metrópolis-guiada.html"><a href="metrópolis-guiada.html#concepto-y-funcionamiento-de-algoritmo-1"><i class="fa fa-check"></i><b>4.1</b> Concepto y funcionamiento de algoritmo</a></li>
<li class="chapter" data-level="4.2" data-path="metrópolis-guiada.html"><a href="metrópolis-guiada.html#implentación-en-r-1"><i class="fa fa-check"></i><b>4.2</b> Implentación en R</a></li>
<li class="chapter" data-level="4.3" data-path="metrópolis-guiada.html"><a href="metrópolis-guiada.html#resultados-e-interpretación-1"><i class="fa fa-check"></i><b>4.3</b> Resultados e interpretación</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="algoritmo-de-metrópolis-guiado-y-adaptativo.html"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html"><i class="fa fa-check"></i><b>5</b> Algoritmo de metrópolis guiado y adaptativo</a>
<ul>
<li class="chapter" data-level="5.1" data-path="algoritmo-de-metrópolis-guiado-y-adaptativo.html"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#concepto-y-funcionamiento-de-algoritmo-2"><i class="fa fa-check"></i><b>5.1</b> Concepto y funcionamiento de algoritmo</a></li>
<li class="chapter" data-level="5.2" data-path="algoritmo-de-metrópolis-guiado-y-adaptativo.html"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#implentación-en-r-2"><i class="fa fa-check"></i><b>5.2</b> Implentación en R</a></li>
<li class="chapter" data-level="5.3" data-path="algoritmo-de-metrópolis-guiado-y-adaptativo.html"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#resultados-e-interpretación-2"><i class="fa fa-check"></i><b>5.3</b> Resultados e interpretación</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="conclusiones.html"><a href="conclusiones.html"><i class="fa fa-check"></i><b>6</b> Conclusiones</a></li>
<li class="chapter" data-level="7" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i><b>7</b> Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Un paseo guiado por el algoritmo de Metrópolis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="metrópolis-de-paseo-aleatorio" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Metrópolis de paseo aleatorio<a href="metrópolis-de-paseo-aleatorio.html#metrópolis-de-paseo-aleatorio" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="concepto-y-funcionamiento-de-algoritmo" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Concepto y funcionamiento de algoritmo<a href="metrópolis-de-paseo-aleatorio.html#concepto-y-funcionamiento-de-algoritmo" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El algoritmo de Paseo Aleatorio Metropolis <em>(algoritmo Random Walk Metropolis en inglés)</em> es un método de Monte Carlo Markov Chain <em>(MCMC)</em> utilizado para explorar distribuciones de probabilidad, especialmente en problemas de inferencia bayesiana. A continuación, se proporciona una explicación detallada de los conceptos y pasos relacionados con este algoritmo.</p>
<p><strong>Definición del problema:</strong> El algoritmo de Paseo Aleatorio Metropolis se utiliza para aproximar la distribución de probabilidad de una variable aleatoria de interés, dada una función objetivo o distribución objetivo. Esta distribución objetivo puede ser la distribución posterior en un problema de inferencia bayesiana.</p>
<p><strong>Generación de una cadena de Markov:</strong> El algoritmo de Paseo Aleatorio Metropolis genera una cadena de Markov, que es una secuencia de estados que evoluciona de acuerdo con ciertas reglas de transición. Cada estado de la cadena representa una posible configuración de la variable aleatoria de interés.</p>
<p><strong>Propuesta de un nuevo estado:</strong> En cada paso de la cadena, se propone un nuevo estado basado en el estado actual. En el caso del algoritmo de Paseo Aleatorio, el nuevo estado se obtiene agregando un ruido aleatorio al estado actual. Comúnmente, se utiliza una distribución normal para generar este ruido, con una media de cero y una variación que se ajusta para controlar la amplitud de los pasos.</p>
<p><strong>Evaluación de la aceptación:</strong> Una vez que se propone un nuevo estado, se evalúa si se acepta o se rechaza. Esto se hace calculando la razón de aceptación, que es la proporción entre la densidad de probabilidad de la distribución objetivo evaluada en el nuevo estado propuesto y la densidad de probabilidad evaluada en el estado actual. Si la razón de aceptación es mayor o igual a uno, se acepta el nuevo estado. Si es menor que uno, se acepta el nuevo estado con una probabilidad igual a la razón de aceptación.</p>
<p><strong>Actualización del estado:</strong> Si se acepta el nuevo estado, se actualiza el estado actual de la cadena con el nuevo estado propuesto. Si se rechaza, se mantiene.</p>
</div>
<div id="implentación-en-r" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Implentación en R<a href="metrópolis-de-paseo-aleatorio.html#implentación-en-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="metrópolis-de-paseo-aleatorio.html#cb19-1" tabindex="-1"></a><span class="co"># initialize</span></span>
<span id="cb19-2"><a href="metrópolis-de-paseo-aleatorio.html#cb19-2" tabindex="-1"></a>M<span class="ot">=</span><span class="dv">10000</span>  <span class="co"># Numero de muestras que se generarán en el algoritmo </span></span>
<span id="cb19-3"><a href="metrópolis-de-paseo-aleatorio.html#cb19-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">91828</span>) <span class="co"># Semilla para inicializar el generador de números aleatorios.</span></span>
<span id="cb19-4"><a href="metrópolis-de-paseo-aleatorio.html#cb19-4" tabindex="-1"></a>beta_post <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">nrow=</span>M, <span class="at">ncol=</span><span class="dv">2</span>) <span class="co"># Matriz para almacenar coeficientes del modelo</span></span>
<span id="cb19-5"><a href="metrópolis-de-paseo-aleatorio.html#cb19-5" tabindex="-1"></a><span class="fu">colnames</span>(beta_post) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;beta0&#39;</span>, <span class="st">&#39;beta1&#39;</span>) <span class="co"># Se asgina nombres a las dos columnas</span></span>
<span id="cb19-6"><a href="metrópolis-de-paseo-aleatorio.html#cb19-6" tabindex="-1"></a>accept <span class="ot">=</span> <span class="fu">numeric</span>(M) <span class="co"># vector númerico con M muestras</span></span>
<span id="cb19-7"><a href="metrópolis-de-paseo-aleatorio.html#cb19-7" tabindex="-1"></a>rd <span class="ot">=</span> <span class="fu">numeric</span>(M) <span class="co"># vector númerico con M muestras</span></span>
<span id="cb19-8"><a href="metrópolis-de-paseo-aleatorio.html#cb19-8" tabindex="-1"></a>beta_post[<span class="dv">1</span>,] <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="sc">-</span><span class="dv">3</span>) <span class="co"># se establece la primera fila con valores iniciales (2, -3)</span></span>
<span id="cb19-9"><a href="metrópolis-de-paseo-aleatorio.html#cb19-9" tabindex="-1"></a>rd[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">riskdifference</span>(y, x, beta_post[<span class="dv">1</span>,]) <span class="co"># dif. de riesgo de las estimaciones</span></span>
<span id="cb19-10"><a href="metrópolis-de-paseo-aleatorio.html#cb19-10" tabindex="-1"></a>accept[<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span> <span class="co"># Vector para registrar si la muestra es aceptada (1) o rechazada (0)</span></span>
<span id="cb19-11"><a href="metrópolis-de-paseo-aleatorio.html#cb19-11" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>M){</span>
<span id="cb19-12"><a href="metrópolis-de-paseo-aleatorio.html#cb19-12" tabindex="-1"></a>  oldb <span class="ot">=</span> beta_post[i<span class="dv">-1</span>,] <span class="co"># almacena coeficiente de la muestra anterior </span></span>
<span id="cb19-13"><a href="metrópolis-de-paseo-aleatorio.html#cb19-13" tabindex="-1"></a>  prop <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">2</span>, <span class="at">sd=</span><span class="fl">0.2</span>) <span class="co"># Genera una muestra para nuevos coeficientes</span></span>
<span id="cb19-14"><a href="metrópolis-de-paseo-aleatorio.html#cb19-14" tabindex="-1"></a>  newb <span class="ot">=</span> oldb<span class="sc">+</span>prop <span class="co"># Calcula los nuevos coeficientes al sumar la propuesta </span></span>
<span id="cb19-15"><a href="metrópolis-de-paseo-aleatorio.html#cb19-15" tabindex="-1"></a>  num <span class="ot">=</span> <span class="fu">loglik</span>(y,x,newb) <span class="co"># Calculan el logaritmo de verosimilitud para newb</span></span>
<span id="cb19-16"><a href="metrópolis-de-paseo-aleatorio.html#cb19-16" tabindex="-1"></a>  den <span class="ot">=</span> <span class="fu">loglik</span>(y,x,oldb) <span class="co"># Calculan el logaritmo de verosimilitud para oldb</span></span>
<span id="cb19-17"><a href="metrópolis-de-paseo-aleatorio.html#cb19-17" tabindex="-1"></a>  acceptprob <span class="ot">=</span> <span class="fu">exp</span>(num<span class="sc">-</span>den) <span class="co"># calcula la /p de aceptar la nueva muestra </span></span>
<span id="cb19-18"><a href="metrópolis-de-paseo-aleatorio.html#cb19-18" tabindex="-1"></a>  acc <span class="ot">=</span> (acceptprob <span class="sc">&gt;</span> <span class="fu">runif</span>(<span class="dv">1</span>)) <span class="co"># aceptar o rechazar la nueva función anterior</span></span>
<span id="cb19-19"><a href="metrópolis-de-paseo-aleatorio.html#cb19-19" tabindex="-1"></a>  <span class="cf">if</span>(acc){</span>
<span id="cb19-20"><a href="metrópolis-de-paseo-aleatorio.html#cb19-20" tabindex="-1"></a>    beta_post[i,] <span class="ot">=</span> newb <span class="co"># se almacenan si es aceptada</span></span>
<span id="cb19-21"><a href="metrópolis-de-paseo-aleatorio.html#cb19-21" tabindex="-1"></a>    accept[i] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb19-22"><a href="metrópolis-de-paseo-aleatorio.html#cb19-22" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb19-23"><a href="metrópolis-de-paseo-aleatorio.html#cb19-23" tabindex="-1"></a>    beta_post[i,] <span class="ot">=</span> oldb </span>
<span id="cb19-24"><a href="metrópolis-de-paseo-aleatorio.html#cb19-24" tabindex="-1"></a>    accept[i] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb19-25"><a href="metrópolis-de-paseo-aleatorio.html#cb19-25" tabindex="-1"></a>  }</span>
<span id="cb19-26"><a href="metrópolis-de-paseo-aleatorio.html#cb19-26" tabindex="-1"></a>  </span>
<span id="cb19-27"><a href="metrópolis-de-paseo-aleatorio.html#cb19-27" tabindex="-1"></a>  <span class="co"># Calcula y almacena la diferencia de riesgo para cada conjunto de estimaciones</span></span>
<span id="cb19-28"><a href="metrópolis-de-paseo-aleatorio.html#cb19-28" tabindex="-1"></a>  rd[i] <span class="ot">=</span> <span class="dv">1000</span><span class="sc">*</span><span class="fu">riskdifference</span>(y, x, beta_post[i,])  </span>
<span id="cb19-29"><a href="metrópolis-de-paseo-aleatorio.html#cb19-29" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="resultados-e-interpretación" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Resultados e interpretación<a href="metrópolis-de-paseo-aleatorio.html#resultados-e-interpretación" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La variable accept se utiliza para hacer un seguimiento de cuántas de las muestras generadas son aceptadas por el algoritmo, esta variable proporciona una medida de la tasa de aceptación promedio durante todas las iteraciones del algoritmo, una tasa de aceptación de aproximadamente <span class="math inline">\(0.6551\)</span> sugiere que el algoritmo de Metropolis-Hastings aceptó alrededor del <span class="math inline">\(65.51\%\)</span> de las muestras generadas, lo que generalmente es una tasa razonable y puede indicar un buen equilibrio entre la exploración eficaz y la convergencia en el espacio de parámetros.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="metrópolis-de-paseo-aleatorio.html#cb20-1" tabindex="-1"></a><span class="fu">mean</span>(accept)</span></code></pre></div>
<pre><code>[1] 0.6551</code></pre>
<p>El resumen estadístico de las muestras de los parámetros beta0 y beta1 revela información clave sobre la distribución de las estimaciones obtenidas a través del algoritmo. Para el parámetro <span class="math inline">\(beta0\)</span>, los valores varían desde aproximadamente <span class="math inline">\(-2.518\)</span> hasta <span class="math inline">\(2.000\)</span>, con una mediana y media en torno a <span class="math inline">\(-1.776\)</span> y <span class="math inline">\(-1.770\)</span>, respectivamente. En cuanto a <span class="math inline">\(beta1\)</span>, oscila entre <span class="math inline">\(-3.9483\)</span> y <span class="math inline">\(3.9189\)</span>, con una mediana y media cercanas a <span class="math inline">\(1.2292\)</span> y <span class="math inline">\(1.1714\)</span>. Estos estadísticos resaltan la variabilidad y proporcionan una estimación central de los parámetros.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="metrópolis-de-paseo-aleatorio.html#cb22-1" tabindex="-1"></a><span class="fu">summary</span>(beta_post)</span></code></pre></div>
<pre><code>     beta0            beta1        
 Min.   :-2.518   Min.   :-3.9483  
 1st Qu.:-1.902   1st Qu.: 0.7389  
 Median :-1.776   Median : 1.2292  
 Mean   :-1.770   Mean   : 1.1714  
 3rd Qu.:-1.651   3rd Qu.: 1.7004  
 Max.   : 2.000   Max.   : 3.9189  </code></pre>
<p>Se calcula la media de las muestras posteriores de beta0 y beta1, excluyendo las primeras <span class="math inline">\(1000\)</span> muestras, esto se hace comúnmente para eliminar las iteraciones iniciales del algoritmo que pueden no haber convergido completamente y para obtener una estimación más precisa de la media posterior. El resultado indica que después de eliminar las primeras <span class="math inline">\(1000\)</span> muestras (que a menudo se descartan como “quemado inicial”), la media posterior estimada para beta0 es aproximadamente <span class="math inline">\(-1.78\)</span> y la media posterior para beta1 es aproximadamente <span class="math inline">\(1.22\)</span>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="metrópolis-de-paseo-aleatorio.html#cb24-1" tabindex="-1"></a>init <span class="ot">=</span> beta_post[<span class="dv">1</span>,]</span>
<span id="cb24-2"><a href="metrópolis-de-paseo-aleatorio.html#cb24-2" tabindex="-1"></a>postmean <span class="ot">=</span> <span class="fu">apply</span>(beta_post[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>),], <span class="dv">2</span>, mean)</span>
<span id="cb24-3"><a href="metrópolis-de-paseo-aleatorio.html#cb24-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Posterior mean</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="fu">round</span>(postmean, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>Posterior mean
 -1.78 1.22</code></pre>
<p>El gráfico muestra visualmente cómo evolucionaron las muestras de los parámetros <span class="math inline">\(beta0\)</span> y <span class="math inline">\(beta1\)</span> a lo largo de las iteraciones del algoritmo, desde el valor inicial (Azul) hasta la media posterior (verde). Esto puede ayudar a comprender cómo convergieron las estimaciones y cómo se distribuyen las muestras posteriormente:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="metrópolis-de-paseo-aleatorio.html#cb26-1" tabindex="-1"></a><span class="fu">plot</span>(beta_post, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.05</span>), <span class="at">xlab=</span><span class="fu">expression</span>(beta[<span class="dv">0</span>]), <span class="at">ylab=</span><span class="fu">expression</span>(beta[<span class="dv">1</span>]), <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="fl">2.5</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">4.5</span>,<span class="fl">4.5</span>))</span>
<span id="cb26-2"><a href="metrópolis-de-paseo-aleatorio.html#cb26-2" tabindex="-1"></a><span class="fu">points</span>(init[<span class="dv">1</span>], init[<span class="dv">2</span>], <span class="at">col=</span><span class="st">&quot;deepskyblue2&quot;</span>, <span class="at">pch=</span><span class="dv">19</span>)</span>
<span id="cb26-3"><a href="metrópolis-de-paseo-aleatorio.html#cb26-3" tabindex="-1"></a><span class="fu">points</span>(postmean[<span class="dv">1</span>], postmean[<span class="dv">2</span>], <span class="at">col=</span><span class="st">&quot;seagreen1&quot;</span>, <span class="at">pch=</span><span class="dv">19</span>)</span>
<span id="cb26-4"><a href="metrópolis-de-paseo-aleatorio.html#cb26-4" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;deepskyblue2&quot;</span>, <span class="st">&quot;seagreen1&quot;</span>), <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Initial value&quot;</span>, <span class="st">&quot;Post. mean&quot;</span>), <span class="at">pch=</span><span class="dv">19</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Muestra cómo cambian las estimaciones de <span class="math inline">\(beta1\)</span> a medida que se ejecutan más iteraciones del algoritmo:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="metrópolis-de-paseo-aleatorio.html#cb27-1" tabindex="-1"></a><span class="fu">plot</span>(beta_post[,<span class="dv">2</span>], <span class="at">type=</span><span class="st">&#39;l&#39;</span>,  <span class="at">ylab=</span><span class="fu">expression</span>(beta[<span class="dv">1</span>]), <span class="at">xlab=</span><span class="st">&quot;Iteration&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Muestra cómo cambia la <em>Diferencia de Riesgo</em> multiplicada por <span class="math inline">\(1000\)</span> a medida que se ejecutan más iteraciones del algoritmo. Este tipo de gráfico es útil para observar la convergencia de las estimaciones de la Diferencia de Riesgo a lo largo del tiempo y para evaluar la variabilidad en las estimaciones:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="metrópolis-de-paseo-aleatorio.html#cb28-1" tabindex="-1"></a><span class="fu">plot</span>(rd, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,  <span class="at">ylab=</span><span class="st">&quot;RD*1000&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Iteration&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Muestra cómo se distribuyen las estimaciones posteriores de beta1 después de eliminar el <em>“quemado inicial”</em>. Este tipo de gráfico es útil para visualizar la incertidumbre en las estimaciones de los parámetros y para identificar modas <em>(picos)</em> en la distribución:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="metrópolis-de-paseo-aleatorio.html#cb29-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(beta_post[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>),<span class="dv">2</span>]), <span class="at">xlab=</span><span class="fu">expression</span>(beta[<span class="dv">1</span>]), <span class="at">ylab=</span><span class="st">&quot;Density&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Muestra cómo se distribuyen las estimaciones de la <em>Diferencia de Riesgo</em> después de eliminar el <em>“quemado inicial”</em>. Este tipo de gráfico es útil para visualizar la incertidumbre en las estimaciones de la Diferencia de Riesgo y para identificar modas <em>(picos)</em> en la distribución:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="metrópolis-de-paseo-aleatorio.html#cb30-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(rd[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)]), <span class="at">xlab=</span><span class="st">&quot;RD*1000&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Density&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="definicion-de-variables-y-funciones-a-utilizar..html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="metrópolis-guiada.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/index.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
