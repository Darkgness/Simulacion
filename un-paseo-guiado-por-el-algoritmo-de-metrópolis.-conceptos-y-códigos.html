<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Un paseo guiado por el algoritmo de Metrópolis. Conceptos y códigos | Un recorrido por el algoritmo Metrópolis</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file. “La ponemos despues”</p>" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Un paseo guiado por el algoritmo de Metrópolis. Conceptos y códigos | Un recorrido por el algoritmo Metrópolis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file. “La ponemos despues”</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Un paseo guiado por el algoritmo de Metrópolis. Conceptos y códigos | Un recorrido por el algoritmo Metrópolis" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file. “La ponemos despues”</p>" />
  

<meta name="author" content="Guillen García Marieth Agnes, Hernández López Idalia" />


<meta name="date" content="2023-10-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="metrópolis-de-paseo-aleatorio.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#funcionamiento-basico-del-algoritmo-metropolis-y-su-relevancia-en-simulacion-estadistica."><i class="fa fa-check"></i><b>1.1</b> Funcionamiento basico del algoritmo Metropolis y su relevancia en simulacion estadistica.</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html"><i class="fa fa-check"></i><b>2</b> Un paseo guiado por el algoritmo de Metrópolis. Conceptos y códigos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#lectura-de-datos"><i class="fa fa-check"></i><b>2.1</b> Lectura de Datos</a></li>
<li class="chapter" data-level="2.2" data-path="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#funciones-auxiliares"><i class="fa fa-check"></i><b>2.2</b> Funciones Auxiliares</a></li>
<li class="chapter" data-level="2.3" data-path="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#estimación-de-máxima-verosimilitud"><i class="fa fa-check"></i><b>2.3</b> Estimación de Máxima Verosimilitud</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="metrópolis-de-paseo-aleatorio.html"><a href="metrópolis-de-paseo-aleatorio.html"><i class="fa fa-check"></i><b>3</b> Metrópolis de paseo aleatorio</a>
<ul>
<li class="chapter" data-level="3.1" data-path="metrópolis-de-paseo-aleatorio.html"><a href="metrópolis-de-paseo-aleatorio.html#concepto-y-funcionamiento-de-algoritmo"><i class="fa fa-check"></i><b>3.1</b> Concepto y funcionamiento de algoritmo</a></li>
<li class="chapter" data-level="3.2" data-path="metrópolis-de-paseo-aleatorio.html"><a href="metrópolis-de-paseo-aleatorio.html#implentación-en-r"><i class="fa fa-check"></i><b>3.2</b> Implentación en R</a></li>
<li class="chapter" data-level="3.3" data-path="metrópolis-de-paseo-aleatorio.html"><a href="metrópolis-de-paseo-aleatorio.html#resultados-e-interpretación"><i class="fa fa-check"></i><b>3.3</b> Resultados e interpretación</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="metrópolis-guiada.html"><a href="metrópolis-guiada.html"><i class="fa fa-check"></i><b>4</b> Metrópolis guiada</a>
<ul>
<li class="chapter" data-level="4.1" data-path="metrópolis-guiada.html"><a href="metrópolis-guiada.html#concepto-y-funcionamiento-de-algoritmo-1"><i class="fa fa-check"></i><b>4.1</b> Concepto y funcionamiento de algoritmo</a></li>
<li class="chapter" data-level="4.2" data-path="metrópolis-guiada.html"><a href="metrópolis-guiada.html#implentación-en-r-1"><i class="fa fa-check"></i><b>4.2</b> Implentación en R</a></li>
<li class="chapter" data-level="4.3" data-path="metrópolis-guiada.html"><a href="metrópolis-guiada.html#resultados-e-interpretación-1"><i class="fa fa-check"></i><b>4.3</b> Resultados e interpretación</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="algoritmo-de-metrópolis-guiado-y-adaptativo.html"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html"><i class="fa fa-check"></i><b>5</b> Algoritmo de metrópolis guiado y adaptativo</a>
<ul>
<li class="chapter" data-level="5.1" data-path="algoritmo-de-metrópolis-guiado-y-adaptativo.html"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#concepto-y-funcionamiento-de-algoritmo-2"><i class="fa fa-check"></i><b>5.1</b> Concepto y funcionamiento de algoritmo</a></li>
<li class="chapter" data-level="5.2" data-path="algoritmo-de-metrópolis-guiado-y-adaptativo.html"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#implentación-en-r-2"><i class="fa fa-check"></i><b>5.2</b> Implentación en R</a></li>
<li class="chapter" data-level="5.3" data-path="algoritmo-de-metrópolis-guiado-y-adaptativo.html"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#resultados-e-interpretación-2"><i class="fa fa-check"></i><b>5.3</b> Resultados e interpretación</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="algoritmo-de-metrópolis-guiado-y-adaptativo-utilizando-priores-normales.html"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo-utilizando-priores-normales.html"><i class="fa fa-check"></i><b>6</b> Algoritmo de metrópolis guiado y adaptativo utilizando priores normales</a>
<ul>
<li class="chapter" data-level="6.1" data-path="algoritmo-de-metrópolis-guiado-y-adaptativo-utilizando-priores-normales.html"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo-utilizando-priores-normales.html#inspeccion-de-salida"><i class="fa fa-check"></i><b>6.1</b> Inspeccion de salida</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="uso-del-paquete-metropolis-en-r.html"><a href="uso-del-paquete-metropolis-en-r.html"><i class="fa fa-check"></i><b>7</b> Uso del paquete Metropolis en R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="uso-del-paquete-metropolis-en-r.html"><a href="uso-del-paquete-metropolis-en-r.html#uso-del-paquete-r-valores-iniciales-inteligentes"><i class="fa fa-check"></i><b>7.1</b> Uso del paquete R, valores iniciales inteligentes</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="uso-del-paquete-metropolis-en-r.html"><a href="uso-del-paquete-metropolis-en-r.html#ampliación-de-los-resultados-del-modelo-logístico-después-de-que-se-generan-las-muestras"><i class="fa fa-check"></i><b>7.1.1</b> Ampliación de los resultados del modelo logístico después de que se generan las muestras</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="limitaciones.html"><a href="limitaciones.html"><i class="fa fa-check"></i><b>8</b> Limitaciones</a></li>
<li class="chapter" data-level="9" data-path="conclusiones.html"><a href="conclusiones.html"><i class="fa fa-check"></i><b>9</b> Conclusiones</a></li>
<li class="chapter" data-level="10" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i><b>10</b> Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Un recorrido por el algoritmo Metrópolis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Un paseo guiado por el algoritmo de Metrópolis. Conceptos y códigos<a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="lectura-de-datos" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Lectura de Datos<a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#lectura-de-datos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Para leer datos en R, se pueden utilizar diversas funciones y métodos según el formato en el que estén los datos o como se deseen trabajar. En la siguiente línea de código los datos que se proporcionan son un ejemplo de variables “y” y “x” que representan casos de leucemia y exposición:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb3-1" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">36</span>), <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">198</span>)) <span class="co"># leukemia cases</span></span>
<span id="cb3-2"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb3-2" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">33</span>), <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">193</span>)) <span class="co"># exposure</span></span></code></pre></div>
<p>Estos datos son típicos en análisis estadísticos y se utilizan para investigar si existe una relación entre la exposición y la ocurrencia de casos de leucemia, por ejemplo, mediante un modelo de regresión logística. La variable “y” sería la variable dependiente (casos de leucemia) y la variable “x” sería la variable independiente (exposición).</p>
</div>
<div id="funciones-auxiliares" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Funciones Auxiliares<a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#funciones-auxiliares" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb4-1" tabindex="-1"></a><span class="co">#helper functions</span></span>
<span id="cb4-2"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb4-2" tabindex="-1"></a>expit <span class="ot">&lt;-</span> <span class="cf">function</span>(mu) <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>mu))</span>
<span id="cb4-3"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb4-4" tabindex="-1"></a>loglik <span class="ot">=</span> <span class="cf">function</span>(y,x,beta){</span>
<span id="cb4-5"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb4-5" tabindex="-1"></a>  <span class="co"># calculate the log likelihood</span></span>
<span id="cb4-6"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb4-6" tabindex="-1"></a>  lli <span class="ot">=</span> <span class="fu">dbinom</span>(y, <span class="dv">1</span>, <span class="fu">expit</span>(beta[<span class="dv">1</span>] <span class="sc">+</span> x<span class="sc">*</span>beta[<span class="dv">2</span>]), <span class="at">log=</span><span class="cn">TRUE</span>)</span>
<span id="cb4-7"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb4-7" tabindex="-1"></a>  <span class="fu">sum</span>(lli)</span>
<span id="cb4-8"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb4-8" tabindex="-1"></a>}</span>
<span id="cb4-9"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb4-10" tabindex="-1"></a>riskdifference <span class="ot">=</span> <span class="cf">function</span>(y,x,beta){</span>
<span id="cb4-11"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb4-11" tabindex="-1"></a>  <span class="co"># baseline odds (offset)</span></span>
<span id="cb4-12"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb4-12" tabindex="-1"></a>  <span class="co"># calculate a risk difference</span></span>
<span id="cb4-13"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb4-13" tabindex="-1"></a>  poprisk <span class="ot">=</span> <span class="fl">4.8</span><span class="sc">/</span><span class="dv">100000</span></span>
<span id="cb4-14"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb4-14" tabindex="-1"></a>  popodds <span class="ot">=</span> poprisk<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>poprisk)</span>
<span id="cb4-15"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb4-15" tabindex="-1"></a>  studyodds <span class="ot">=</span> <span class="fu">mean</span>(y)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">mean</span>(y))</span>
<span id="cb4-16"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb4-16" tabindex="-1"></a>  r1 <span class="ot">=</span> <span class="fu">expit</span>(<span class="fu">log</span>(popodds<span class="sc">/</span>studyodds) <span class="sc">+</span> beta[<span class="dv">1</span>] <span class="sc">+</span> beta[<span class="dv">2</span>])</span>
<span id="cb4-17"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb4-17" tabindex="-1"></a>  r0 <span class="ot">=</span> <span class="fu">expit</span>(<span class="fu">log</span>(popodds<span class="sc">/</span>studyodds) <span class="sc">+</span> beta[<span class="dv">1</span>])</span>
<span id="cb4-18"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb4-18" tabindex="-1"></a>  <span class="fu">mean</span>(r1<span class="sc">-</span>r0)</span>
<span id="cb4-19"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb4-19" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="estimación-de-máxima-verosimilitud" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Estimación de Máxima Verosimilitud<a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#estimación-de-máxima-verosimilitud" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Es un método estadístico utilizado para estimar los parámetros de un modelo estadístico, busca encontrar los valores de los parámetros que maximizan la verosimilitud de que los datos observados sean generados por el modelo propuesto.</p>
<p>A continuación, se presenta cómo funciona la estimación de máxima verosimilitud en R:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb5-1" tabindex="-1"></a><span class="co"># data se utiliza para ajustar un modelo de regresión logística binaria</span></span>
<span id="cb5-2"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb5-2" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">leuk=</span>y, <span class="at">magfield=</span>x)</span>
<span id="cb5-3"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb5-4" tabindex="-1"></a><span class="co"># Ajuste del modelo de regresión logística, para predecir la relacion de las variables</span></span>
<span id="cb5-5"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb5-5" tabindex="-1"></a><span class="co"># indicar que se trata de un modelo binomial</span></span>
<span id="cb5-6"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb5-6" tabindex="-1"></a>mod <span class="ot">=</span> <span class="fu">glm</span>(leuk <span class="sc">~</span> magfield, <span class="at">family=</span><span class="fu">binomial</span>(), <span class="at">data=</span>data)</span>
<span id="cb5-7"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb5-7" tabindex="-1"></a></span>
<span id="cb5-8"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb5-8" tabindex="-1"></a><span class="co"># Resumen del modelo y extracción de coeficientes:</span></span>
<span id="cb5-9"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb5-9" tabindex="-1"></a><span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>             Estimate Std. Error   z value     Pr(&gt;|z|)
(Intercept) -1.766183   0.188373 -9.375988 6.853094e-21
magfield     1.255357   0.754200  1.664488 9.601492e-02</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb7-1" tabindex="-1"></a>beta1 <span class="ot">=</span> <span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb7-2"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb7-2" tabindex="-1"></a>se1 <span class="ot">=</span> <span class="fu">summary</span>(mod)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb7-3"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb7-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">Maximum likelihood beta coefficient (95% CI)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>

Maximum likelihood beta coefficient (95% CI)</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb9-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">beta=</span>beta1, <span class="at">ll=</span>beta1<span class="sc">+</span>se1<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.025</span>), <span class="at">ul=</span>beta1<span class="sc">+</span>se1<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)), <span class="dv">2</span>)</span></code></pre></div>
<pre><code> beta    ll    ul 
 1.26 -0.22  2.73 </code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb11-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">Maximum likelihood odds ratio (95% CI)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>

Maximum likelihood odds ratio (95% CI)</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb13-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">exp</span>(<span class="fu">c</span>(<span class="at">beta=</span>beta1, <span class="at">ll=</span>beta1<span class="sc">+</span>se1<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.025</span>), <span class="at">ul=</span>beta1<span class="sc">+</span>se1<span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>))), <span class="dv">2</span>)</span></code></pre></div>
<pre><code> beta    ll    ul 
 3.51  0.80 15.39 </code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb15-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">Maximum likelihood risk difference (multiplied by 1000) </span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>

Maximum likelihood risk difference (multiplied by 1000) </code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="un-paseo-guiado-por-el-algoritmo-de-metrópolis.-conceptos-y-códigos.html#cb17-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">rd_1000=</span><span class="fu">riskdifference</span>(y,x,mod<span class="sc">$</span>coefficients)<span class="sc">*</span><span class="dv">1000</span>), <span class="dv">2</span>)</span></code></pre></div>
<pre><code>rd_1000 
   0.11 </code></pre>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="metrópolis-de-paseo-aleatorio.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/index.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
