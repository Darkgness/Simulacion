<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Metrópolis guiada | Un paseo guiado por el algoritmo de Metrópolis</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file. “La ponemos despues”</p>" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Metrópolis guiada | Un paseo guiado por el algoritmo de Metrópolis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file. “La ponemos despues”</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Metrópolis guiada | Un paseo guiado por el algoritmo de Metrópolis" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file. “La ponemos despues”</p>" />
  

<meta name="author" content="Guillen García Marieth Agnes, Hernández López Idalia" />


<meta name="date" content="2023-10-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="metrópolis-de-paseo-aleatorio.html"/>
<link rel="next" href="algoritmo-de-metrópolis-guiado-y-adaptativo.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#funcionamiento-basico-del-algoritmo-metropolis-y-su-relevancia-en-simulacion-estadistica."><i class="fa fa-check"></i><b>1.1</b> Funcionamiento basico del algoritmo Metropolis y su relevancia en simulacion estadistica.</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="definicion-de-variables-y-funciones-a-utilizar..html"><a href="definicion-de-variables-y-funciones-a-utilizar..html"><i class="fa fa-check"></i><b>2</b> Definicion de variables y funciones a utilizar.</a>
<ul>
<li class="chapter" data-level="2.1" data-path="definicion-de-variables-y-funciones-a-utilizar..html"><a href="definicion-de-variables-y-funciones-a-utilizar..html#lectura-de-datos"><i class="fa fa-check"></i><b>2.1</b> Lectura de Datos</a></li>
<li class="chapter" data-level="2.2" data-path="definicion-de-variables-y-funciones-a-utilizar..html"><a href="definicion-de-variables-y-funciones-a-utilizar..html#funciones-auxiliares"><i class="fa fa-check"></i><b>2.2</b> Funciones Auxiliares</a></li>
<li class="chapter" data-level="2.3" data-path="definicion-de-variables-y-funciones-a-utilizar..html"><a href="definicion-de-variables-y-funciones-a-utilizar..html#estimación-de-máxima-verosimilitud"><i class="fa fa-check"></i><b>2.3</b> Estimación de Máxima Verosimilitud</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="metrópolis-de-paseo-aleatorio.html"><a href="metrópolis-de-paseo-aleatorio.html"><i class="fa fa-check"></i><b>3</b> Metrópolis de paseo aleatorio</a>
<ul>
<li class="chapter" data-level="3.1" data-path="metrópolis-de-paseo-aleatorio.html"><a href="metrópolis-de-paseo-aleatorio.html#concepto-y-funcionamiento-de-algoritmo"><i class="fa fa-check"></i><b>3.1</b> Concepto y funcionamiento de algoritmo</a></li>
<li class="chapter" data-level="3.2" data-path="metrópolis-de-paseo-aleatorio.html"><a href="metrópolis-de-paseo-aleatorio.html#implentación-en-r"><i class="fa fa-check"></i><b>3.2</b> Implentación en R</a></li>
<li class="chapter" data-level="3.3" data-path="metrópolis-de-paseo-aleatorio.html"><a href="metrópolis-de-paseo-aleatorio.html#resultados-e-interpretación"><i class="fa fa-check"></i><b>3.3</b> Resultados e interpretación</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="metrópolis-guiada.html"><a href="metrópolis-guiada.html"><i class="fa fa-check"></i><b>4</b> Metrópolis guiada</a>
<ul>
<li class="chapter" data-level="4.1" data-path="metrópolis-guiada.html"><a href="metrópolis-guiada.html#concepto-y-funcionamiento-de-algoritmo-1"><i class="fa fa-check"></i><b>4.1</b> Concepto y funcionamiento de algoritmo</a></li>
<li class="chapter" data-level="4.2" data-path="metrópolis-guiada.html"><a href="metrópolis-guiada.html#implentación-en-r-1"><i class="fa fa-check"></i><b>4.2</b> Implentación en R</a></li>
<li class="chapter" data-level="4.3" data-path="metrópolis-guiada.html"><a href="metrópolis-guiada.html#resultados-e-interpretación-1"><i class="fa fa-check"></i><b>4.3</b> Resultados e interpretación</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="algoritmo-de-metrópolis-guiado-y-adaptativo.html"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html"><i class="fa fa-check"></i><b>5</b> Algoritmo de metrópolis guiado y adaptativo</a>
<ul>
<li class="chapter" data-level="5.1" data-path="algoritmo-de-metrópolis-guiado-y-adaptativo.html"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#concepto-y-funcionamiento-de-algoritmo-2"><i class="fa fa-check"></i><b>5.1</b> Concepto y funcionamiento de algoritmo</a></li>
<li class="chapter" data-level="5.2" data-path="algoritmo-de-metrópolis-guiado-y-adaptativo.html"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#implentación-en-r-2"><i class="fa fa-check"></i><b>5.2</b> Implentación en R</a></li>
<li class="chapter" data-level="5.3" data-path="algoritmo-de-metrópolis-guiado-y-adaptativo.html"><a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html#resultados-e-interpretación-2"><i class="fa fa-check"></i><b>5.3</b> Resultados e interpretación</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="conclusiones.html"><a href="conclusiones.html"><i class="fa fa-check"></i><b>6</b> Conclusiones</a></li>
<li class="chapter" data-level="7" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i><b>7</b> Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Un paseo guiado por el algoritmo de Metrópolis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="metrópolis-guiada" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Metrópolis guiada<a href="metrópolis-guiada.html#metrópolis-guiada" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="concepto-y-funcionamiento-de-algoritmo-1" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Concepto y funcionamiento de algoritmo<a href="metrópolis-guiada.html#concepto-y-funcionamiento-de-algoritmo-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El algoritmo de Paseo Guiado Metropolis es una variante del algoritmo Metropolis de Paseo Aleatorio que busca mejorar su eficiencia y convergencia. A continuación, se proporciona una explicación detallada de los conceptos y pasos relacionados con este algoritmo.</p>
<p><strong>Definición del problema:</strong> El algoritmo de Paseo Guiado Metropolis se utiliza para aproximar la distribución de probabilidad de una variable aleatoria de interés, dada una función objetivo o distribución objetivo. Esta distribución objetivo puede ser la distribución posterior en un problema de inferencia bayesiana.</p>
<p><strong>Generación de una cadena de Markov:</strong> Al igual que en el algoritmo de Paseo Aleatorio Metropolis, el algoritmo de Paseo Guiado Metropolis genera una cadena de Markov, que es una secuencia de estados que evoluciona de acuerdo con ciertas reglas de transición. Cada estado de la cadena representa una posible configuración de la variable aleatoria de interés.</p>
<p><strong>Propuesta de un nuevo estado:</strong> En cada paso de la cadena, se propone un nuevo estado basado en el estado actual. Sin embargo, a diferencia del algoritmo de Paseo Aleatorio Metropolis, en el algoritmo de Paseo Guiado Metropolis se utiliza una guía o dirección para generar el nuevo estado propuesto. Esta guía puede ser determinada por información adicional o conocimiento previo sobre la distribución objetivo.</p>
<p><strong>Evaluación de la aceptación:</strong> Una vez que se propone un nuevo estado, se evalúa si se acepta o se rechaza. Esto se hace calculando la razón de aceptación, que es la proporción entre la densidad de probabilidad de la distribución objetivo evaluada en el nuevo estado propuesto y la densidad de probabilidad evaluada en el estado actual. Si la razón de aceptación es mayor o igual a uno, se acepta el nuevo estado. Si es menor que uno, se acepta el nuevo estado con una probabilidad igual a la razón de aceptación.</p>
<p><strong>Actualización del estado:</strong> Si se acepta el nuevo estado, se actualiza el estado actual de la cadena con el nuevo estado propuesto. Si se rechaza el nuevo estado, se mantiene el estado actual sin cambios.</p>
</div>
<div id="implentación-en-r-1" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Implentación en R<a href="metrópolis-guiada.html#implentación-en-r-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="metrópolis-guiada.html#cb31-1" tabindex="-1"></a><span class="co"># initialize</span></span>
<span id="cb31-2"><a href="metrópolis-guiada.html#cb31-2" tabindex="-1"></a>M<span class="ot">=</span><span class="dv">10000</span> <span class="co"># Numero de muestras que se generarán en el algoritmo</span></span>
<span id="cb31-3"><a href="metrópolis-guiada.html#cb31-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">91828</span>) <span class="co"># Semilla para inicializar el generador de números aleatorios</span></span>
<span id="cb31-4"><a href="metrópolis-guiada.html#cb31-4" tabindex="-1"></a>beta_post_guide <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">nrow=</span>M, <span class="at">ncol=</span><span class="dv">2</span>) <span class="co"># Matriz para almacenar coeficientes del modelo</span></span>
<span id="cb31-5"><a href="metrópolis-guiada.html#cb31-5" tabindex="-1"></a><span class="fu">colnames</span>(beta_post_guide) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;beta0&#39;</span>, <span class="st">&#39;beta1&#39;</span>) <span class="co"># Se asgina nombres a las dos columnas</span></span>
<span id="cb31-6"><a href="metrópolis-guiada.html#cb31-6" tabindex="-1"></a>accept <span class="ot">=</span> <span class="fu">numeric</span>(M) <span class="co"># vector númerico con M muestra</span></span>
<span id="cb31-7"><a href="metrópolis-guiada.html#cb31-7" tabindex="-1"></a>rd_guide <span class="ot">=</span> <span class="fu">numeric</span>(M) <span class="co"># vector númerico con M muestra</span></span>
<span id="cb31-8"><a href="metrópolis-guiada.html#cb31-8" tabindex="-1"></a>beta_post_guide[<span class="dv">1</span>,] <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="sc">-</span><span class="dv">3</span>)  <span class="co"># se establece la primera fila con valores iniciales (2, -3)</span></span>
<span id="cb31-9"><a href="metrópolis-guiada.html#cb31-9" tabindex="-1"></a>rd_guide[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">riskdifference</span>(y,x,beta_post_guide[<span class="dv">1</span>,]) <span class="co"># dif. de riesgo de las estimaciones</span></span>
<span id="cb31-10"><a href="metrópolis-guiada.html#cb31-10" tabindex="-1"></a>accept[<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span> <span class="co"># Vector para registrar si la muestra es aceptada (1) o rechazada (0)</span></span>
<span id="cb31-11"><a href="metrópolis-guiada.html#cb31-11" tabindex="-1"></a>dir <span class="ot">=</span> <span class="dv">1</span> <span class="co"># Esta variable se utiliza para controlar la dirección de exploración</span></span>
<span id="cb31-12"><a href="metrópolis-guiada.html#cb31-12" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>M){</span>
<span id="cb31-13"><a href="metrópolis-guiada.html#cb31-13" tabindex="-1"></a>  oldb <span class="ot">=</span> beta_post_guide[i<span class="dv">-1</span>,] <span class="co"># almacena los coeficientes de la muestra anterior</span></span>
<span id="cb31-14"><a href="metrópolis-guiada.html#cb31-14" tabindex="-1"></a>  prop <span class="ot">=</span> dir<span class="sc">*</span><span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">2</span>, <span class="at">sd=</span><span class="fl">0.2</span>)) <span class="co"># muestra para nuevos coeficientes multiplicando por dir</span></span>
<span id="cb31-15"><a href="metrópolis-guiada.html#cb31-15" tabindex="-1"></a>  newb <span class="ot">=</span> oldb<span class="sc">+</span>prop <span class="co"># Calcula los nuevos coeficientes al sumar la propuesta </span></span>
<span id="cb31-16"><a href="metrópolis-guiada.html#cb31-16" tabindex="-1"></a>  num <span class="ot">=</span> <span class="fu">loglik</span>(y,x,newb) <span class="co"># Calculan el logaritmo de verosimilitud para newb</span></span>
<span id="cb31-17"><a href="metrópolis-guiada.html#cb31-17" tabindex="-1"></a>  den <span class="ot">=</span> <span class="fu">loglik</span>(y,x,oldb) <span class="co"># Calculan el logaritmo de verosimilitud para oldb</span></span>
<span id="cb31-18"><a href="metrópolis-guiada.html#cb31-18" tabindex="-1"></a>  acceptprob <span class="ot">=</span> <span class="fu">exp</span>(num<span class="sc">-</span>den) <span class="co"># calcula la /p de aceptar la nueva muestra </span></span>
<span id="cb31-19"><a href="metrópolis-guiada.html#cb31-19" tabindex="-1"></a>  acc <span class="ot">=</span> (acceptprob <span class="sc">&gt;</span> <span class="fu">runif</span>(<span class="dv">1</span>)) <span class="co"># aceptar o rechazar la nueva función anterior</span></span>
<span id="cb31-20"><a href="metrópolis-guiada.html#cb31-20" tabindex="-1"></a>  <span class="cf">if</span>(acc){</span>
<span id="cb31-21"><a href="metrópolis-guiada.html#cb31-21" tabindex="-1"></a>    beta_post_guide[i,] <span class="ot">=</span> newb </span>
<span id="cb31-22"><a href="metrópolis-guiada.html#cb31-22" tabindex="-1"></a>    accept[i] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb31-23"><a href="metrópolis-guiada.html#cb31-23" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb31-24"><a href="metrópolis-guiada.html#cb31-24" tabindex="-1"></a>    beta_post_guide[i,] <span class="ot">=</span> oldb </span>
<span id="cb31-25"><a href="metrópolis-guiada.html#cb31-25" tabindex="-1"></a>    accept[i] <span class="ot">=</span> <span class="dv">0</span> <span class="co"># si la muestra es rechazada (acc == 0)</span></span>
<span id="cb31-26"><a href="metrópolis-guiada.html#cb31-26" tabindex="-1"></a>    dir <span class="ot">=</span> dir<span class="sc">*-</span><span class="dv">1</span> <span class="co"># se invierte la dirección dir multiplicándola por -1.</span></span>
<span id="cb31-27"><a href="metrópolis-guiada.html#cb31-27" tabindex="-1"></a>    <span class="co"># cambia la dirección de exploración en el espacio de parámetros.</span></span>
<span id="cb31-28"><a href="metrópolis-guiada.html#cb31-28" tabindex="-1"></a>  }</span>
<span id="cb31-29"><a href="metrópolis-guiada.html#cb31-29" tabindex="-1"></a>  </span>
<span id="cb31-30"><a href="metrópolis-guiada.html#cb31-30" tabindex="-1"></a>  <span class="co"># Calcula y almacena la diferencia de riesgo para cada conjunto de estimaciones</span></span>
<span id="cb31-31"><a href="metrópolis-guiada.html#cb31-31" tabindex="-1"></a>  rd_guide[i] <span class="ot">=</span> <span class="dv">1000</span><span class="sc">*</span><span class="fu">riskdifference</span>(y,x,beta_post_guide[i,]) </span>
<span id="cb31-32"><a href="metrópolis-guiada.html#cb31-32" tabindex="-1"></a>  </span>
<span id="cb31-33"><a href="metrópolis-guiada.html#cb31-33" tabindex="-1"></a>}</span>
<span id="cb31-34"><a href="metrópolis-guiada.html#cb31-34" tabindex="-1"></a></span>
<span id="cb31-35"><a href="metrópolis-guiada.html#cb31-35" tabindex="-1"></a><span class="co"># se calcula el valor del posterior promedio de los coeficientes </span></span>
<span id="cb31-36"><a href="metrópolis-guiada.html#cb31-36" tabindex="-1"></a><span class="co"># para las muestras posteriores a las primeras 1000</span></span>
<span id="cb31-37"><a href="metrópolis-guiada.html#cb31-37" tabindex="-1"></a>postmean <span class="ot">=</span> <span class="fu">apply</span>(beta_post_guide[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>),], <span class="dv">2</span>, mean)</span>
<span id="cb31-38"><a href="metrópolis-guiada.html#cb31-38" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Posterior mean, guided</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="fu">round</span>(postmean, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>Posterior mean, guided
 -1.8 1.41</code></pre>
</div>
<div id="resultados-e-interpretación-1" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Resultados e interpretación<a href="metrópolis-guiada.html#resultados-e-interpretación-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Estos gráficos de traza se utilizan para visualizar cómo evolucionan las estimaciones de <span class="math inline">\(beta1\)</span> a lo largo de las iteraciones y para comparar dos enfoques diferentes. La sobreposición de las trazas muestra cómo se comparan las estimaciones de ambos enfoques y si uno converge más rápido o es más efectivo:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="metrópolis-guiada.html#cb33-1" tabindex="-1"></a>col1 <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">5</span>)</span>
<span id="cb33-2"><a href="metrópolis-guiada.html#cb33-2" tabindex="-1"></a>col2 <span class="ot">=</span> <span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">35</span>)</span>
<span id="cb33-3"><a href="metrópolis-guiada.html#cb33-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb33-4"><a href="metrópolis-guiada.html#cb33-4" tabindex="-1"></a></span>
<span id="cb33-5"><a href="metrópolis-guiada.html#cb33-5" tabindex="-1"></a><span class="co">#trace plots</span></span>
<span id="cb33-6"><a href="metrópolis-guiada.html#cb33-6" tabindex="-1"></a><span class="fu">plot</span>(beta_post[<span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>,<span class="dv">2</span>], <span class="at">type=</span><span class="st">&#39;l&#39;</span>,  <span class="at">ylab=</span><span class="fu">expression</span>(beta[<span class="dv">1</span>]), <span class="at">xlab=</span><span class="st">&quot;Iteration&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>), <span class="at">col=</span>col1)</span>
<span id="cb33-7"><a href="metrópolis-guiada.html#cb33-7" tabindex="-1"></a><span class="fu">lines</span>(beta_post_guide[<span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>,<span class="dv">2</span>], <span class="at">col=</span>col2)</span>
<span id="cb33-8"><a href="metrópolis-guiada.html#cb33-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(col1, col2), <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Rand. walk&quot;</span>, <span class="st">&quot;Guided&quot;</span>))</span>
<span id="cb33-9"><a href="metrópolis-guiada.html#cb33-9" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">9800</span><span class="sc">:</span><span class="dv">10000</span>, beta_post[<span class="dv">9800</span><span class="sc">:</span><span class="dv">10000</span>,<span class="dv">2</span>], <span class="at">type=</span><span class="st">&#39;l&#39;</span>,  <span class="at">ylab=</span><span class="fu">expression</span>(beta[<span class="dv">1</span>]), <span class="at">xlab=</span><span class="st">&quot;Iteration&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>), <span class="at">col=</span>col1)</span>
<span id="cb33-10"><a href="metrópolis-guiada.html#cb33-10" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">9800</span><span class="sc">:</span><span class="dv">10000</span>, beta_post_guide[<span class="dv">9800</span><span class="sc">:</span><span class="dv">10000</span>,<span class="dv">2</span>], <span class="at">col=</span>col2)</span>
<span id="cb33-11"><a href="metrópolis-guiada.html#cb33-11" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(col1, col2), <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Rand. walk&quot;</span>, <span class="st">&quot;Guided&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Estos gráficos de densidad se utilizan para comparar visualmente las distribuciones de las estimaciones de beta1 y la Diferencia de Riesgo (RD) multiplicada por <span class="math inline">\(1000\)</span> obtenidas mediante los dos enfoques r. Pueden ayudar a determinar si uno de los enfoques produce resultados más concentrados o si hay diferencias notables en las estimaciones posteriores:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="metrópolis-guiada.html#cb34-1" tabindex="-1"></a><span class="co"># density plots</span></span>
<span id="cb34-2"><a href="metrópolis-guiada.html#cb34-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(beta_post_guide[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>),<span class="dv">2</span>]), <span class="at">col=</span>col2, <span class="at">xlab=</span><span class="fu">expression</span>(beta[<span class="dv">1</span>]), <span class="at">ylab=</span><span class="st">&quot;Density&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb34-3"><a href="metrópolis-guiada.html#cb34-3" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(beta_post[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>),<span class="dv">2</span>]), <span class="at">col=</span>col1)</span>
<span id="cb34-4"><a href="metrópolis-guiada.html#cb34-4" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(col1, col2), <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Rand. walk&quot;</span>, <span class="st">&quot;Guided&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="metrópolis-guiada.html#cb35-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(rd_guide[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)]), <span class="at">xlab=</span><span class="st">&quot;RD*1000&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Density&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">col=</span>col2)</span>
<span id="cb35-2"><a href="metrópolis-guiada.html#cb35-2" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(rd[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)]), <span class="at">col=</span>col1)</span>
<span id="cb35-3"><a href="metrópolis-guiada.html#cb35-3" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(col1, col2), <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Rand. walk&quot;</span>, <span class="st">&quot;Guided&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="metrópolis-guiada.html#cb36-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="metrópolis-de-paseo-aleatorio.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="algoritmo-de-metrópolis-guiado-y-adaptativo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/index.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
